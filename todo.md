update algorithm - move (b) outside (1)